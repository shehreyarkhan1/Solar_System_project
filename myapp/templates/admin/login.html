<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>User Login</title>
    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <!-- Font Awesome -->
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
      rel="stylesheet"
    />
    <!-- Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  </head>
  <body class="bg-light">
    <div
      class="container-fluid vh-100 d-flex align-items-center justify-content-center"
    >
      <div class="row w-100 justify-content-center">
        <div class="col-12 col-sm-8 col-md-6 col-lg-4 col-xl-3">
          <div class="card shadow-lg">
            <div class="card-header bg-success text-white text-center">
              <h3><i class="fas fa-sign-in-alt"></i> User Login</h3>
            </div>
            <div class="card-body">
              {% if messages %} {% for message in messages %}
              <div
                class="alert alert-danger alert-{{ message.tags }} alert-dismissible fade show"
                role="alert"
              >
                {{ message }}
                <button
                  type="button"
                  class="btn-close"
                  data-bs-dismiss="alert"
                ></button>
              </div>
              {% endfor %} {% endif %}

              <form method="post" id="loginForm" novalidate>
                {% csrf_token %}

                <!-- Username Field -->
                <div class="mb-3">
                  <label for="username" class="form-label">
                    <i class="fas fa-user"></i> Username
                    <span class="text-danger">*</span>
                  </label>
                  <input
                    type="text"
                    class="form-control"
                    id="username"
                    name="username"
                    value="{{ request.POST.username|default:'' }}"
                    placeholder="Enter your username"
                    required
                    autocomplete="username"
                  />
                  <div class="invalid-feedback">
                    Please enter your username.
                  </div>
                </div>

                <!-- Password Field -->
                <div class="mb-3">
                  <label for="password" class="form-label">
                    <i class="fas fa-lock"></i> Password
                    <span class="text-danger">*</span>
                  </label>
                  <div class="input-group">
                    <input
                      type="password"
                      class="form-control"
                      id="password"
                      name="password"
                      placeholder="Enter your password"
                      required
                      autocomplete="current-password"
                    />
                    <button
                      class="btn btn-outline-secondary"
                      type="button"
                      id="togglePassword"
                    >
                      <i class="fas fa-eye" id="eyeIcon"></i>
                    </button>
                  </div>
                  <div class="invalid-feedback">
                    Please enter your password.
                  </div>
                </div>

                <!-- Remember Me -->
                <div class="mb-3 form-check">
                  <input
                    type="checkbox"
                    class="form-check-input"
                    id="remember"
                    name="remember"
                  />
                  <label class="form-check-label" for="remember">
                    <i class="fas fa-remember"></i> Remember me
                  </label>
                </div>

                <!-- Submit Button -->
                <div class="d-grid">
                  <button
                    type="submit"
                    class="btn btn-success btn-lg"
                    id="loginBtn"
                  >
                    <i class="fas fa-sign-in-alt"></i> Login
                  </button>
                </div>

                <!-- Additional Links -->
                {% comment %}
                <div class="text-center mt-3">
                  <div class="mb-2">
                    <a href="#" class="text-muted text-decoration-none small">
                      <i class="fas fa-key"></i> Forgot Password?
                    </a>
                  </div>
                  <hr class="my-3" />
                  <p class="mb-0">
                    Don't have an account?
                    <a href="" class="text-success text-decoration-none fw-bold"
                      >Register here</a
                    >
                  </p>
                </div>
                {% endcomment %}
              </form>
            </div>

            <!-- Footer -->
            <div class="card-footer bg-light text-center text-muted small">
              <i class="fas fa-shield-alt"></i> Your login is secure and
              encrypted
            </div>
          </div>
        </div>
      </div>
    </div>

    <style>
      .card {
        border: none;
        border-radius: 15px;
        overflow: hidden;
      }

      .card-header {
        background: linear-gradient(135deg, #28a745, #20c997) !important;
        border: none;
        padding: 1.5rem;
      }

      .card-body {
        padding: 2rem;
      }

      .form-control {
        border-radius: 10px;
        border: 2px solid #e9ecef;
        padding: 12px 16px;
        font-size: 16px;
        transition: all 0.3s ease;
      }

      .form-control:focus {
        border-color: #28a745;
        box-shadow: 0 0 0 0.2rem rgba(40, 167, 69, 0.25);
        transform: translateY(-2px);
      }

      .btn-success {
        background: linear-gradient(135deg, #28a745, #20c997);
        border: none;
        border-radius: 10px;
        padding: 12px;
        font-size: 18px;
        font-weight: 600;
        transition: all 0.3s ease;
      }

      .btn-success:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(40, 167, 69, 0.3);
      }

      .btn-outline-secondary {
        border-radius: 0 10px 10px 0;
        border-left: none;
      }

      .input-group .form-control {
        border-radius: 10px 0 0 10px;
      }

      .form-check-input:checked {
        background-color: #28a745;
        border-color: #28a745;
      }

      .alert {
        border-radius: 10px;
        border: none;
      }

      .card-footer {
        background: rgba(248, 249, 250, 0.8) !important;
        border-top: 1px solid rgba(0, 0, 0, 0.1);
      }

      /* Loading animation */
      .btn-loading {
        pointer-events: none;
        opacity: 0.7;
      }

      .spinner-border-sm {
        width: 1rem;
        height: 1rem;
      }

      /* Shake animation for errors */
      @keyframes shake {
        0%,
        100% {
          transform: translateX(0);
        }
        25% {
          transform: translateX(-5px);
        }
        75% {
          transform: translateX(5px);
        }
      }

      .shake {
        animation: shake 0.5s ease-in-out;
      }
    </style>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const form = document.getElementById("loginForm");
        const password = document.getElementById("password");
        const togglePassword = document.getElementById("togglePassword");
        const eyeIcon = document.getElementById("eyeIcon");
        const loginBtn = document.getElementById("loginBtn");
        const username = document.getElementById("username");

        // Toggle password visibility
        togglePassword.addEventListener("click", function () {
          const type =
            password.getAttribute("type") === "password" ? "text" : "password";
          password.setAttribute("type", type);
          eyeIcon.classList.toggle("fa-eye");
          eyeIcon.classList.toggle("fa-eye-slash");
        });

        // Form validation
        function validateForm() {
          let isValid = true;

          // Remove previous validation states
          username.classList.remove("is-invalid");
          password.classList.remove("is-invalid");

          if (!username.value.trim()) {
            username.classList.add("is-invalid");
            isValid = false;
          }

          if (!password.value) {
            password.classList.add("is-invalid");
            isValid = false;
          }

          return isValid;
        }

        // Real-time validation
        username.addEventListener("input", function () {
          if (this.value.trim()) {
            this.classList.remove("is-invalid");
            this.classList.add("is-valid");
          }
        });

        password.addEventListener("input", function () {
          if (this.value) {
            this.classList.remove("is-invalid");
            this.classList.add("is-valid");
          }
        });

        // Form submission
        form.addEventListener("submit", function (e) {
          if (!validateForm()) {
            e.preventDefault();

            // Shake the form for visual feedback
            form.classList.add("shake");
            setTimeout(() => form.classList.remove("shake"), 500);

            // Show error message
            showAlert("Please fill in all required fields.", "danger");
            return;
          }

          // Show loading state
          loginBtn.innerHTML = `
            <span class="spinner-border spinner-border-sm me-2" role="status"></span>
            Logging in...
        `;
          loginBtn.classList.add("btn-loading");
        });

        // Function to show alerts
        function showAlert(message, type) {
          const existingAlert = document.querySelector(".alert");
          if (existingAlert) {
            existingAlert.remove();
          }

          const alert = document.createElement("div");
          alert.className = `alert alert-${type} alert-dismissible fade show`;
          alert.innerHTML = `
            ${message}
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        `;

          form.insertBefore(alert, form.firstChild);

          // Auto-dismiss after 5 seconds
          setTimeout(() => {
            if (alert.parentNode) {
              alert.remove();
            }
          }, 5000);
        }

        // Enter key support
        document.addEventListener("keypress", function (e) {
          if (
            e.key === "Enter" &&
            (document.activeElement === username ||
              document.activeElement === password)
          ) {
            form.dispatchEvent(new Event("submit"));
          }
        });

        // Auto-focus username field
        username.focus();

        // Remember me functionality (store in localStorage)
        const rememberCheckbox = document.getElementById("remember");

        // Load remembered username
        const rememberedUsername = localStorage.getItem("rememberedUsername");
        if (rememberedUsername) {
          username.value = rememberedUsername;
          rememberCheckbox.checked = true;
          password.focus(); // Focus password if username is remembered
        }

        // Save/remove username based on remember me
        form.addEventListener("submit", function () {
          if (rememberCheckbox.checked) {
            localStorage.setItem("rememberedUsername", username.value);
          } else {
            localStorage.removeItem("rememberedUsername");
          }
        });
      });
    </script>
  </body>
</html>
